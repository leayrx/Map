<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Carte collaborative</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
}

#map {
  width: 100%;
  height: 100%;
}

/* CONTENEUR UI AU-DESSUS DE LA CARTE */
#ui-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 2000;
  pointer-events: none;
}

#ui-container > div {
  pointer-events: auto;
}


/* ------------------------------
   POPUP ROLE SP/VICT (centrée)
---------------------------------*/
#role-popup { 
  position: absolute; 
  top: 10px; left: 50%; 
  transform: translateX(-50%); 
  background: white; 
  padding: 10px; 
  border-radius: 5px; 
  box-shadow: 0 0 10px rgba(0,0,0,0.3); }


/* ------------------------------
   LOGIN SPALS (centrée)
---------------------------------*/
#login-popup {
  position: absolute; 
  top: 10px; left: 50%; 
  transform: translateX(-50%); 
  background: white; 
  padding: 10px; 
  border-radius: 5px; 
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  display: none;
}

/* ------------------------------
   FORMULAIRE POINT ROUGE
---------------------------------*/
#red-popup {/*
  position: absolute;
  bottom: 80px;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  padding: 10px;
  border-radius: 5px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  display: none;
  z-index: 4000;*/


  position: absolute; 
  top: 10px; left: 50%; 
  transform: translateX(-50%); 
  background: white; 
  padding: 10px; 
  border-radius: 5px; 
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  display: none;
}
#red-popup input { width: 90px; }

/* ------------------------------
   FORMULAIRE POINT BLANC (fixe, bas gauche)
---------------------------------*/
#white-point-popup {
  position: absolute;
  bottom: 20px;
  left: 20px;
  background: white;
  padding: 12px 16px;
  border-radius: 6px;
  box-shadow: 0 0 12px rgba(0,0,0,0.4);
  z-index: 3000;
  max-width: 220px;
  text-align: center;
}
#white-point-popup input { width: 100px; margin: 2px; }
#white-point-popup button { margin-top: 4px; cursor: pointer; }

/* ------------------------------
   FORMULAIRE POINT ROUGE MANUEL
---------------------------------*/
#red-form {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: white;
  padding: 10px 12px;
  border-radius: 5px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
  z-index: 2000;
  max-width: 300px;
}
#red-form input { width: 120px; margin: 2px; }
#red-form button { margin-top: 4px; margin-right: 4px; cursor: pointer; }

/* LAYER SELECTOR GPX */
#layer-selector {
  position: absolute;
  top: 10px;
  right: 10px;
  background: white;
  padding: 8px;
  border-radius: 5px;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
}

/* GPS WARNING */
#gps-warning {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: #e3f2fd;
  padding: 8px 12px;
  border-radius: 5px;
  font-weight: bold;
  box-shadow: 0 0 8px rgba(0,0,0,0.3);
  display: none;
}

/* BOUTON ADMIN */
#btn-admin {
  position: absolute;
  bottom: 10px;
  right: 10px;
  background: #1976d2;
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 5px;
  cursor: pointer;
  z-index: 3000;
}
</style>
</head>

<body>

<div id="map"></div>

<div id="ui-container">

  <!-- ROLE SP/VICT (centrée) -->
  <div id="role-popup">
    <strong>Choisissez votre rôle</strong><br><br>
    <button id="btn-sp">SP</button>
    <button id="btn-vict">VICT</button>
  </div>

  <!-- Indicateur Admin -->
<div id="admin-status" style="position:absolute;top:10px;left:10px;
  background:#1976d2;color:white;padding:5px 10px;border-radius:4px;
  display:none; z-index:4000;">
  Admin connecté
</div>

  <!-- LOGIN SPALS (centrée) -->
  <div id="login-popup">
    <strong>Connexion Admin</strong><br><br>
    <input type="text" id="login-id" placeholder="Identifiant"><br><br>
    <input type="password" id="login-pass" placeholder="Mot de passe"><br><br>
    <button id="login-btn">Se connecter</button>
    <button id="login-cancel">Annuler</button>
    <p id="login-error" style="color:red; display:none;">Identifiant ou mot de passe incorrect</p>
  </div>

  <!-- FORMULAIRE POINT ROUGE -->
  <div id="red-popup">
    <strong>Ajouter un point rouge</strong><br><br>
    <input id="red-lat" placeholder="Lat">
    <input id="red-lng" placeholder="Lng"><br><br>
    <input id="red-title" placeholder="Légende">
    <input type="file" id="red-photo"><br><br>
    <button id="red-add-btn">Ajouter</button>
    <button id="red-close-btn">Fermer</button>
  </div>

  <!-- FORMULAIRE POINT BLANC FIXE (visible pour tous) -->
  <div id="white-point-popup">
    <strong>Ajouter un point blanc</strong><br><br>
    <input id="white-lat" placeholder="Lat">
    <input id="white-lng" placeholder="Lng"><br><br>
    <input id="white-name" placeholder="Nom">
    <button id="white-add-btn">Ajouter</button>
  </div>

  <!-- FORMULAIRE POINT ROUGE MANUEL -->
  <div id="red-form" style="display:block;">
    <strong>Ajouter un point manuel</strong><br><br>
    <input id="lat-input" placeholder="Lat">
    <input id="lng-input" placeholder="Lng"><br><br>
    <input id="red-name" placeholder="Nom">
    <button id="add-red-marker">Ajouter</button>
    <button id="btn-login">Admin Login</button>
  </div>

  <!-- MENU GPX + BALISE -->
  <div id="layer-selector">
    <strong>Moyens</strong><br>
    <select id="layer" multiple size="8">
      <option value="PIETON">Piéton</option>
      <option value="VLI">VLI</option>
      <option value="VLTT">VLTT</option>
      <option value="VSAV">VSAV</option>
      <option value="CTU">CTU</option>
      <option value="FPT">FPT</option>
      <option value="CCF">CCF</option>
      <option value="BALISE">Balise</option>
    </select>
  </div>

  <div id="gps-warning"></div>
</div>

<button id="btn-admin">Admin</button>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.7.0/gpx.min.js"></script>
<script src="js/map.js"></script>

</body>
</html>
